<div class="group_controller">
    <H1 class='pagetitle'>View This Group</H1>
    <br>
    <div class="container">
        <div id="groupcontainer" class='groupcontainer table table-hover table-bordered table-dark table-responsive table-condensed'>
            <H2 class='pagetitle'>View Group</H2>
            <br>
            <center>
                <table id="groupmembertable" class="table table-hover table-bordered table-condensed">
                    <thead class="thead-light">
                        <th><a class="UP" onclick="sortGroupTableByColumn(0,'groupmembertable')" href="javascript:void(0);">Member Name</a></th>
                        <th><a class="UP" onclick="sortGroupTableByColumn(1,'groupmembertable')" href="javascript:void(0);">Member Score</a></th>
                        <th><a class="UP" onclick="sortGroupTableByColumn(2,'groupmembertable',false,true)" href="javascript:void(0);">Last Activity</a></th>
                    </thead>
                    <tbody>
                        <% @users.each do |user| %>
                            <% if user.id == current_user.id %>
                                <tr class="curgroup">
                                    <td><%= user.full_name %></td>
                                    <% if @scores[user.id]==nil %>
                                        <td>Has done nothing</td>
                                    <% elsif @scores[user.id]==0%>
                                        <td>Has done nothing</td>
                                    <% else %>
                                        <td><%= user.score.round(4) %></td>
                                    <% end %>
                                    <% if user.lastActivity == nil %>
                                        <td id="1e100000"><%= user.full_name %> has not yet participated.</td>
                                    <% else %>
                                        <%= content_tag :td, :id =>user.lastActivity.created_at do %>
                                            <%= user.lastActivity.name %> at <%= user.lastActivity.created_at.in_time_zone("Central Time (US & Canada)").strftime("%H:%M on %a, %m/%d/%y")%>
                                        <% end %>
                                    <% end %>
                                </tr>
                            <% else %>
                                <tr>
                                    <td><%= user.full_name %></td>
                                    <% if @scores[user.id]==nil %>
                                        <td>Has done nothing</td>
                                    <% elsif @scores[user.id]==0%>
                                        <td>Has done nothing</td>
                                    <% else %>
                                        <td><%= user.score.round(4) %></td>
                                    <% end %>
                                    <% if user.lastActivity == nil %>
                                        <td id="1e100000"><%= user.full_name %> has not yet participated.</td>
                                    <% else %>
                                        <%= content_tag :td, :id =>user.lastActivity.created_at do %>
                                            <%= user.lastActivity.name %> at <%= user.lastActivity.created_at.in_time_zone("Central Time (US & Canada)").strftime("%H:%M on %a, %m/%d/%y")%>
                                        <% end %>
                                    <% end %>
                                </tr>
                            <% end %>
                        <% end %>
                    </tbody>
                </table>
            </center>
            <br>
            <br>
            <div id="messageContainer">
                <H4 class="justify-content-center">Messages for <%= @group.name %></H4>
                <div class="row">
                        <table id="messageTable" class="table table-striped table-hover table-borderless table-sm">
                            <tbody>
                                <% @messages.each do |msg|%>
                                    <tr>
                                        <% if msg.userid == current_user.id %>
                                            <td class="username">You:</td>
                                        <% else %>
                                            <td class="username"><%= msg.userName%></td>
                                        <% end %>
                                        <td class="message col-sm-10 text-sm-left"><%= msg.message %></td>
                                    </tr>
                                <% end %>
                            </tbody>
                        </table>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="messageInput">
                </div>
                <div class="col-sm-2">
                    <button type="button" class="btn btn-light" onclick="submitMessage()">Submit Message</button>
                </div>
            </div>
            <br>
            <br>
            <p class="link"><%= link_to 'Back', url_for(:back), :class => 'backitem'%></p>
        </div>
    </div>
</div>